/* --- Global Styles & Variables --- */
:root {
    --primary-color: #e6007e; /* Vibrant Pink */
    --secondary-color: #6a0dad; /* Deep Purple */
    --accent-color: #ffd700; /* Gold */
    --background-start: #f9f9f9;
    --background-end: #e8e8e8;
    --text-color: #333;
    --text-light: #fff;
    --container-bg: rgba(255, 255, 255, 0.97);
    --card-bg: #ffffff;
    --highlight-bg: #fdf2f7; /* Very light pink */
    --border-color: #d8d8d8;
    --shadow-color-light: rgba(0, 0, 0, 0.06);
    --shadow-color-medium: rgba(0, 0, 0, 0.12);
    --shadow-color-strong: rgba(106, 13, 173, 0.2);

    /* Placement Colors */
    --win-color: royalblue;
    --top2-color: cyan;
    --high-color: lightblue; /* Updated this value */
    --safe-color: #f5f5f5;
    --low-color: lightpink;
    --btm-color: tomato;
    --elim-color: red;
    --immune-color: #90caf9;
    --winner-color: var(--accent-color);
    --runnerup-color: #c0c0c0;

    --font-family: 'Poppins', sans-serif;
    --base-font-size: 16px;
    --border-radius: 12px;
    --border-radius-small: 8px;

    /* Transitions */
    --transition-fast: all 0.15s ease-in-out;
    --transition-std: all 0.25s ease-in-out;
}

/* --- Base & Typography --- */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: var(--font-family);
    font-size: var(--base-font-size);
    line-height: 1.6;
    color: var(--text-color);
    background: linear-gradient(140deg, var(--background-start) 0%, var(--background-end) 100%),
                url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23c7c7c7" fill-opacity="0.06"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');
    padding: 25px;
    min-height: 100vh;
    font-weight: 400;
}

.container {
    max-width: 1400px; /* Adjusted width */
    margin: 25px auto;
    background: var(--container-bg);
    padding: 45px;
    border-radius: var(--border-radius);
    box-shadow: 0 15px 40px var(--shadow-color-medium), 0 0 0 1px var(--border-color);
    backdrop-filter: blur(5px);
}

h1, h2, h3, h4 {
    color: var(--secondary-color);
    margin-bottom: 25px;
    text-align: center;
    font-weight: 600;
    letter-spacing: 0.5px;
    line-height: 1.3;
}
h1 {
    font-size: 3em; font-weight: 700; color: var(--primary-color);
    text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.8), 3px 3px 5px var(--shadow-color-medium);
    margin-bottom: 15px;
}
.subtitle {
    text-align: center; font-size: 1.2em; color: #777;
    margin-top: -10px; margin-bottom: 40px; font-weight: 300;
}
h2 {
    font-size: 2.4em; font-weight: 700; margin-bottom: 20px;
    padding-bottom: 10px; border-bottom: 1px solid var(--border-color);
    position: relative;
}
h2::after {
    content: '‚≠ê'; position: absolute; bottom: -10px; left: 50%;
    transform: translateX(-50%); color: var(--accent-color);
    font-size: 0.5em; opacity: 0.7;
}
h3 { font-size: 1.7em; margin-top: 35px; font-weight: 600;}
h4 { font-size: 1.4em; color: var(--primary-color); font-weight: 600;} /* Adjusted h4 color */

hr {
    border: 0; height: 2px;
    background-image: linear-gradient(to right, transparent, var(--primary-color), transparent);
    margin: 40px 0; opacity: 0.5;
}

.hidden { display: none !important; }

/* --- Screen Management --- */
.screen {
    padding: 30px; border: 1px solid transparent;
    border-radius: var(--border-radius); margin-top: 25px;
    background-color: transparent;
}
.screen-header {
    margin-bottom: 30px; padding-bottom: 15px;
    border-bottom: 1px solid var(--border-color);
}
.screen-header h2 { border-bottom: none; margin-bottom: 5px; }
.screen-header h2::after { display: none; }
.screen-header p { text-align: center; color: #666; font-size: 1.1em; }

/* --- Form Elements --- */
.setup-options {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px; margin-bottom: 40px;
}
.option-group label:not([for*="toggle"]) {
    font-weight: 600; font-size: 1em; color: var(--secondary-color);
    margin-bottom: 5px; display: block;
}
.option-group select, .option-group input[type="range"], .option-group input[type="checkbox"] {
    margin-top: 5px;
}
select, input[type="range"], input[type="text"], input[type="number"] {
    width: 100%; padding: 12px 15px; border: 1px solid var(--border-color);
    border-radius: var(--border-radius-small); font-family: inherit; font-size: 0.95em;
    background-color: white; transition: border-color var(--transition-std), box-shadow var(--transition-std);
}
select:focus, input:focus {
    outline: none; border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(230, 0, 126, 0.2);
}
select {
     appearance: none;
     background-image: url('data:image/svg+xml;utf8,<svg fill="%236a0dad" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
     background-repeat: no-repeat; background-position: right 10px center;
     background-size: 20px; padding-right: 40px;
}
input[type="range"] {
    cursor: pointer; padding: 0; accent-color: var(--primary-color);
}
input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none; appearance: none; width: 20px; height: 20px;
    background: var(--primary-color); border-radius: 50%; cursor: pointer;
    box-shadow: 0 0 5px var(--shadow-color-strong);
}
input[type="range"]::-moz-range-thumb {
    width: 20px; height: 20px; background: var(--primary-color); border-radius: 50%;
    cursor: pointer; border: none; box-shadow: 0 0 5px var(--shadow-color-strong);
}
#riggory-value {
    display: inline-block; margin-left: 15px; font-weight: 700;
    font-size: 1.1em; color: var(--primary-color); min-width: 25px; text-align: right;
}

/* Toggle Switch */
label[for*="toggle"] { display: flex; align-items: center; cursor: pointer; font-size: 0.95em; position: relative; }
label[for*="toggle"] input[type="checkbox"] { opacity: 0; width: 0; height: 0; position: absolute; }
.toggle-switch {
    position: relative; display: inline-block; width: 44px; height: 24px;
    background-color: #ccc; border-radius: 24px; transition: background-color var(--transition-std);
    margin-right: 10px; flex-shrink: 0;
}
.toggle-switch::before {
    content: ""; position: absolute; height: 18px; width: 18px; left: 3px; bottom: 3px;
    background-color: white; border-radius: 50%; transition: transform var(--transition-std);
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
input[type="checkbox"]:checked + .toggle-switch { background-color: var(--primary-color); }
input[type="checkbox"]:checked + .toggle-switch::before { transform: translateX(20px); }
label[for*="toggle"] small {
    font-size: 0.85em; color: #777; margin-top: 2px; display: block; padding-left: 54px;
}

/* --- Buttons --- */
button {
    font-family: var(--font-family); padding: 12px 28px; border: none;
    border-radius: var(--border-radius-small); cursor: pointer; font-size: 1em;
    font-weight: 600; transition: var(--transition-std); margin: 5px;
    text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 3px 6px var(--shadow-color-medium);
    position: relative; overflow: hidden; z-index: 1;
}
button::after {
    content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
    background: rgba(255, 255, 255, 0.15); transform: rotate(45deg);
    transition: none; opacity: 0; pointer-events: none;
}
button:hover::after { opacity: 1; transition: opacity 0.4s ease, transform 0.4s ease; transform: rotate(45deg) translate(20px, -20px); }
button:active { transform: scale(0.96); box-shadow: inset 0 2px 4px rgba(0,0,0,0.15); }
button:disabled { background-color: #d1d1d1 !important; color: #888 !important; cursor: not-allowed; box-shadow: none; transform: none; opacity: 0.7; }
button:disabled::after { display: none; }

.action-button { background-image: linear-gradient(45deg, var(--primary-color), #c4006b); color: var(--text-light); }
.action-button:hover:not(:disabled) { box-shadow: 0 6px 12px var(--shadow-color-strong); transform: translateY(-2px); }
.control-button { background-image: linear-gradient(45deg, var(--secondary-color), #8a3fda); color: var(--text-light); }
.control-button:hover:not(:disabled) { box-shadow: 0 6px 12px var(--shadow-color-strong); transform: translateY(-2px); }
.control-button.danger, .button-style.clear-button { background-image: linear-gradient(45deg, var(--elim-color), #c4403c); border-color: var(--elim-color); color: white; }
.control-button.danger:hover:not(:disabled), .button-style.clear-button:hover { background-image: linear-gradient(45deg, #c4403c, #a03431); box-shadow: 0 6px 12px rgba(217, 83, 79, 0.3); transform: translateY(-2px); }

.navigation-buttons { margin-top: 40px; text-align: center; display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }

/* Small utility button */
.small-button { padding: 8px 18px; font-size: 0.9em; letter-spacing: 0.5px;}


/* --- Cast/Queen Selection --- */
#cast-selection-buttons { display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin: 20px 0; }
.button-style {
    font-family: var(--font-family); padding: 8px 18px; border: 1px solid var(--secondary-color); background-color: white;
    color: var(--secondary-color); border-radius: var(--border-radius-small); cursor: pointer; font-size: 0.9em; font-weight: 500;
    transition: var(--transition-std); box-shadow: 0 1px 3px var(--shadow-color-light);
}
.button-style:hover { background-color: var(--secondary-color); color: white; transform: translateY(-2px); box-shadow: 0 4px 8px var(--shadow-color-medium); }
.button-style:active { transform: translateY(0); box-shadow: inset 0 1px 3px rgba(0,0,0,0.1); }
.button-style.clear-button { border-color: var(--elim-color); color: var(--elim-color); } /* Already defined above */

.queen-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 20px; margin-bottom: 25px;
    padding: 20px; border: 1px solid var(--border-color); border-radius: var(--border-radius); max-height: 480px; overflow-y: auto;
    background-color: #fdfdfd; scrollbar-width: thin; scrollbar-color: var(--secondary-color) var(--background-end);
}
.queen-grid::-webkit-scrollbar { width: 8px; }
.queen-grid::-webkit-scrollbar-track { background: var(--background-end); border-radius: 4px; }
.queen-grid::-webkit-scrollbar-thumb { background-color: var(--secondary-color); border-radius: 4px; border: 2px solid var(--background-end); }

.queen-selector {
    display: flex; flex-direction: column; align-items: center; cursor: pointer; padding: 12px; border: 3px solid transparent;
    border-radius: var(--border-radius); transition: var(--transition-std); text-align: center; background-color: var(--card-bg);
    box-shadow: 0 3px 8px var(--shadow-color-light); position: relative; overflow: hidden;
}
.queen-selector::before { /* Hover gradient */
    content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background: linear-gradient(45deg, rgba(230, 0, 126, 0.3), rgba(106, 13, 173, 0.3));
    opacity: 0; transition: var(--transition-fast); z-index: 1; pointer-events: none;
}
.queen-selector img {
    width: 80px; height: 80px; object-fit: cover; border-radius: 50%; margin-bottom: 10px; border: 4px solid var(--border-color);
    transition: border-color var(--transition-std); z-index: 2; position: relative;
}
.queen-selector span {
    font-size: 0.9em; font-weight: 600; word-break: break-word; z-index: 2; position: relative; color: var(--text-color);
    background-color: rgba(255,255,255,0.6); padding: 2px 5px; border-radius: 3px;
}
.queen-selector:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 6px 12px var(--shadow-color-medium); }
.queen-selector:hover::before { opacity: 0.6; }
.queen-selector:hover img { border-color: var(--primary-color); }
.queen-selector.selected { border-color: var(--primary-color); box-shadow: 0 0 15px var(--shadow-color-strong), 0 4px 10px var(--shadow-color-medium); }
.queen-selector.selected::before { opacity: 0.8; }
.queen-selector.selected img { border-color: var(--accent-color); }

.selection-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 30px; padding-top: 20px; border-top: 1px dashed var(--border-color); }
#selected-count { font-weight: 700; font-size: 1.15em; }

/* --- Game Screen Specifics --- */
.game-header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid var(--border-color); }
.game-header p { font-size: 1.15em; color: #555; font-weight: 500; }
.game-header span { color: var(--primary-color); font-weight: 700; }

#active-queens-display-container {
    margin: 30px 0; padding: 20px; background-color: rgba(230, 230, 230, 0.5); border-radius: var(--border-radius);
    border: 1px solid var(--border-color); backdrop-filter: blur(3px);
}
#active-queens-display-container h4 {
    font-size: 1.1em; font-weight: 700; color: var(--secondary-color); margin-bottom: 15px; text-align: center; padding-left: 0; margin-top: 0;
}
#active-queens-display {
    display: flex; flex-wrap: nowrap; justify-content: flex-start; gap: 15px; overflow-x: auto;
    padding: 10px 5px 15px 5px; min-height: 110px; scrollbar-width: thin; scrollbar-color: var(--primary-color) #d1d1d1;
}
#active-queens-display::-webkit-scrollbar { height: 10px; }
#active-queens-display::-webkit-scrollbar-track { background: #d1d1d1; border-radius: 5px; }
#active-queens-display::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: 5px; border: 2px solid #d1d1d1; }
#active-queens-display::-webkit-scrollbar-thumb:hover { background-color: #c4006b; }

.active-display-card {
    flex-shrink: 0; width: 90px; background-color: #fff; border: 1px solid var(--border-color); border-radius: var(--border-radius-small);
    box-shadow: 0 2px 5px var(--shadow-color-light); padding: 10px; text-align: center; transition: var(--transition-std); position: relative;
}
.active-display-card:hover { transform: translateY(-3px); box-shadow: 0 4px 8px var(--shadow-color-medium); }
.active-display-card img { width: 60px; height: 60px; border-radius: 50%; margin-bottom: 8px; border: 2px solid #eee; object-fit: cover; }
.active-display-card span { font-size: 0.8em; font-weight: 600; display: block; line-height: 1.2; word-break: break-word; }
.active-display-card.immune { border-left: 5px solid var(--immune-color); box-shadow: 0 2px 6px rgba(144, 202, 249, 0.5); }
.active-display-card .immunity-badge { /* Icon for immunity on active card */
    position: absolute; top: -6px; right: -6px; background-color: transparent; color: var(--immune-color);
    font-size: 1.2em; padding: 0; text-shadow: 0 0 3px rgba(0,0,0,0.4); line-height: 1; width: auto; height: auto;
}
/* MQP Points Display on Active Card */
.active-display-card .active-card-points {
    position: absolute; top: -5px; left: -5px; background-color: var(--secondary-color); color: white;
    border-radius: 50%; width: 26px; height: 26px; font-size: 0.8em; line-height: 26px; /* Center vertically */
    font-weight: 700; box-shadow: 0 1px 3px rgba(0,0,0,0.3); text-align: center; z-index: 5;
}
.active-display-card .active-card-points.zero { background-color: #aaa; }

.interaction-box.ru-interaction-box p {
    max-width: 80%;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    color: #555;
}

/* Challenge Announcement Area */
.main-challenge-area { text-align: center; margin: 35px 0; padding: 20px; background-color: #fdf0f7; border: 1px dashed var(--primary-color); border-radius: var(--border-radius); }
#challenge-announcement { font-weight: 700; font-size: 1.4em; color: var(--primary-color); padding: 5px 0; margin-bottom: 8px; display: block; }
#challenge-description { font-size: 1.05em; color: #444; line-height: 1.5; max-width: 800px; margin: 0 auto; font-style: normal; }
#challenge-description:not(:empty) { padding-top: 10px; border-top: 1px solid #eeddee; margin-top: 10px; }

/* Interaction Boxes (General) */
.interaction-box { margin-top: 40px; padding: 30px; border: 1px solid var(--border-color); border-radius: var(--border-radius); text-align: center; background-color: #fafcff; box-shadow: 0 4px 10px var(--shadow-color-light); }
.interaction-box .interaction-title, #lipsync-title { margin-top: 0; margin-bottom: 20px; font-weight: 700; color: var(--secondary-color); font-size: 1.5em; display: flex; align-items: center; justify-content: center; gap: 10px; }
.interaction-box .interaction-title .icon { font-size: 1.2em; }
/* Sub-interaction box (e.g., Elim Choice, Ru Decision within Lipsync Info) */
.sub-interaction-box { margin-top: 25px; padding-top: 20px; border-top: 1px dashed #ccc; }
.interaction-title.small-title { font-size: 1.3em; margin-bottom: 15px; }

/* Choice Card Containers */
.choice-card-container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin: 25px 0; }
.choice-card-container.slim-gap { gap: 15px; margin: 15px 0; }
.vs-container { align-items: center; } /* Align items vertically in VS display */
.vs-container span.vs-text { font-size: 2.8em; font-weight: 700; align-self: center; padding: 0 20px; color: var(--primary-color); text-shadow: 1px 1px 3px var(--shadow-color-medium); }

/* ==== Consolidated Enhanced Choice Card Styles ==== */
/* Base Enhanced Card - Applies wherever .choice-button-card.enhanced is used */
.choice-button-card.enhanced {
    display: flex; flex-direction: column; justify-content: flex-start;
    width: 180px; min-height: 240px;
    background-color: var(--card-bg); border: 2px solid var(--border-color);
    border-radius: var(--border-radius); box-shadow: 0 4px 8px var(--shadow-color-light);
    text-align: center; position: relative; /* IMPORTANT: Parent needs relative positioning */ overflow: hidden; padding: 0;
    transition: var(--transition-std); cursor: pointer;
}
/* Style the riggory choice container */
.choice-card-container.riggory-gap {
    gap: 15px; /* Slightly smaller gap */
    margin-bottom: 20px;
}

/* Style instruction/info text */
#rupaul-riggory-selection .instruction-text {
    font-size: 0.95em;
    color: #444;
    margin-bottom: 25px;
    line-height: 1.5;
}
#riggory-challenge-info .challenge-name-placeholder {
    font-style: italic;
    color: #888;
}
#rupaul-riggory-selection .favor-icon { color: #28a745; font-weight: bold;}
#rupaul-riggory-selection .penalty-icon { color: #dc3545; font-weight: bold;}

/* Style the container for riggory buttons on the card */
.choice-button-card .riggory-actions {
    position: absolute;
    bottom: 5px; /* Position at the bottom */
    left: 5px;
    right: 5px;
    display: flex;
    justify-content: space-around; /* Space out buttons */
    padding: 0px 5px;
    z-index: 5; /* Below stats summary */
     opacity: 0; /* Hide initially */
     transition: opacity 0.2s ease-in-out;
}

.choice-button-card:hover .riggory-actions {
     opacity: 1; /* Show buttons on hover */
}


/* Style individual riggory action buttons/icons */
.choice-button-card .riggory-action-btn {
    background-color: rgba(245, 245, 245, 0.9); /* Slightly off-white */
    border: 1px solid #ccc;
    border-radius: 50%;
    width: 30px;  /* Slightly smaller */
    height: 30px; /* Slightly smaller */
    /* font-size: 1.2em; /* REMOVE emoji font-size */
    font-size: 1.5em; /* Larger font-size for symbols */
    font-weight: bold; /* Make symbols bolder */
    line-height: 28px; /* Adjust line-height to center symbols */
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    padding: 0; /* Remove default padding */
    /* Ensure default button styles aren't interfering */
    appearance: none;
    -webkit-appearance: none;
}

.choice-button-card .riggory-action-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.choice-button-card .riggory-action-btn.favor-btn {
    border-color: #28a745;
    color: #28a745;
}
.choice-button-card .riggory-action-btn.favor-btn:hover {
    background-color: #28a745; /* Green background on hover */
    color: white; /* White symbol on hover */
}

.choice-button-card .riggory-action-btn.penalty-btn {
    border-color: #dc3545;
    color: #dc3545;
}
.choice-button-card .riggory-action-btn.penalty-btn:hover {
    background-color: #dc3545; /* Red background on hover */
    color: white; /* White symbol on hover */
}

/* Update selected states */
.choice-button-card.selected-favor .riggory-action-btn.favor-btn {
     background-color: #28a745; color: white; transform: scale(1.1);
}
/* Make the *other* button less prominent when one is selected */
.choice-button-card.selected-favor .riggory-action-btn.penalty-btn {
     opacity: 0.5; pointer-events: none; /* Dim and disable */
}

.choice-button-card.selected-penalty .riggory-action-btn.penalty-btn {
     background-color: #dc3545; color: white; transform: scale(1.1);
}
/* Make the *other* button less prominent when one is selected */
.choice-button-card.selected-penalty .riggory-action-btn.favor-btn {
    opacity: 0.5; pointer-events: none; /* Dim and disable */
}

/* Make stats summary slightly smaller/pushed up if needed */
.choice-button-card .card-stats-summary.enhanced {
   padding: 8px 10px 40px 10px; /* INCREASE bottom padding to make space for buttons */
   min-height: 5.5em; /* Adjust min-height */
}
/* Inner structure: Main Info (Image, Name, Score) */
.choice-button-card.enhanced .card-main-info {
    padding: 15px 15px 10px 15px; /* Restore default padding if it changed */
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    position: relative; /* <<< ADD: Establish stacking context */
    z-index: 1;         /* <<< ADD: Ensure it's below the warning icon */
}
/* Image inside Enhanced Card */
.choice-button-card.enhanced .card-main-info img {
    width: 85px; height: 85px; object-fit: cover; border-radius: 50%;
    margin: 0 auto 12px auto; display: block;
    border: 3px solid #f0f0f0;
    transition: border-color var(--transition-std), transform 0.2s ease-out;
}
.choice-button-card.enhanced .name-score-group { margin-bottom: 10px; width: 100%; }
.choice-button-card.enhanced .queen-name { font-size: 1.1em; font-weight: 600; line-height: 1.3; display: block; color: var(--secondary-color); padding: 0 5px; }
.choice-button-card.enhanced .queen-score { font-size: 0.85em; color: #777; display: block; margin-top: 3px; font-weight: 400; }

/* Inner structure: Stats Summary */
.choice-button-card.enhanced .card-stats-summary.enhanced {
    width: 100%;
    margin-top: auto;
    border-top: 1px solid #eee;
    background-color: #f9f9fb;
    padding: 10px 10px 12px 10px;
    text-align: left;
    min-height: 4.5em;
    position: relative; /* <<< ADD: Establish stacking context */
    z-index: 1;         /* <<< ADD: Ensure it's below the warning icon */
}


.choice-button-card.enhanced .card-stat-line {
    display: block; font-size: 0.9em; line-height: 1.4;
    margin-bottom: 2px; font-weight: 500; color: #444; padding-left: 5px;
}
.choice-button-card.enhanced .card-stat-line:last-child { margin-bottom: 0; }
.choice-button-card.enhanced .card-stat-line .stat-icon { display: inline-block; width: 1.5em; text-align: center; margin-right: 4px; font-size: 1.1em;}
.choice-button-card.enhanced .card-stat-line.win { color: var(--win-color); font-weight: 600; }
.choice-button-card.enhanced .card-stat-line.high { color: #388e3c; }
.choice-button-card.enhanced .card-stat-line.btm { color: var(--btm-color); }
.choice-button-card.enhanced .card-stat-line.low { color: var(--low-color); }
.choice-button-card.enhanced .card-stat-line.mqp { color: var(--secondary-color); }
.choice-button-card.enhanced .card-stat-line.safe { color: #777; }


/* Specific Card Selection Highlight for LOW SAVE */
#low-save-choice-options .choice-button-card.enhanced.selected {
    border-color: var(--high-color); box-shadow: 0 0 12px rgba(60, 139, 64, 0.3), 0 4px 10px var(--shadow-color-medium); background-color: #f2fff2; }
#low-save-choice-options .choice-button-card.enhanced.selected .card-main-info img { border-color: var(--high-color); }


/* Adjust warning icon positioning and z-index */
.choice-button-card.enhanced .card-warning {
    position: absolute;
    top: 6px;       /* Keep slightly offset */
    right: 6px;      /* Keep slightly offset */
    z-index: 10;    /* <<< ENSURE this is higher than content */
    background-color: rgba(255, 165, 0, 0.9); /* Existing style */
    color: white;
    width: 20px;    /* Existing style */
    height: 20px;   /* Existing style */
    font-size: 0.9em;/* Existing style */
    border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    text-shadow: none; box-shadow: 0 1px 2px rgba(0,0,0,0.3); cursor: help;
}

/* Hover/Selected States for Enhanced Cards */
.choice-button-card.enhanced:hover { border-color: var(--accent-color); box-shadow: 0 6px 15px var(--shadow-color-medium); transform: translateY(-5px) scale(1.03); }
.choice-button-card.enhanced:hover .card-main-info img { transform: scale(1.05); border-color: var(--accent-color); }
.choice-button-card.enhanced.selected { border-color: var(--primary-color); box-shadow: 0 0 12px var(--shadow-color-strong), 0 4px 10px var(--shadow-color-medium); background-color: #fff8fb; }
.choice-button-card.enhanced.selected .card-main-info img { border-color: var(--primary-color); }

/* Context-specific Hover/Select Overrides */
#elimination-choice-options .choice-button-card.enhanced:hover { border-color: var(--elim-color); }
#elimination-choice-options .choice-button-card.enhanced:hover .card-main-info img { border-color: var(--elim-color); }
#elimination-choice-options .choice-button-card.enhanced.selected { border-color: var(--elim-color); background-color: #fee; }
#elimination-choice-options .choice-button-card.enhanced.selected .card-main-info img { border-color: var(--elim-color); }

/* Double Shantay Button */
.control-button.double-shantay { margin-top: 15px; background-image: linear-gradient(45deg, var(--accent-color), #ffec8b); color: #333; box-shadow: 0 3px 6px rgba(255, 215, 0, 0.3); }
.control-button.double-shantay:hover:not(:disabled) { box-shadow: 0 6px 12px rgba(255, 215, 0, 0.4); transform: translateY(-2px); }

/* Other Interaction UI */
#lsfyl-winner-announcement { border: 2px dashed var(--primary-color); background-color: var(--highlight-bg); margin: 20px auto; padding: 18px; border-radius: var(--border-radius); max-width: 80%; box-shadow: 0 3px 8px var(--shadow-color-light); }
#lsfyl-winner-announcement p { font-size: 1.1em; font-weight: 500; margin: 0 0 5px 0; color: #444; }
#lsfyl-winner-announcement p.winner-name { font-size: 1.4em; }
#lsfyl-winner-name { font-weight: 700; color: var(--primary-color); }
.elim-button { background-image: linear-gradient(45deg, var(--elim-color), #a03431); color: var(--text-light); }
.elim-button:hover:not(:disabled) { box-shadow: 0 6px 12px rgba(217, 83, 79, 0.3); transform: translateY(-2px); }


/* --- Episode Results & Critiques --- */
.results-display { margin-top: 40px; padding: 25px; border: 1px solid var(--border-color); border-radius: var(--border-radius); background-color: #f9f9f9; position: relative; box-shadow: inset 0 2px 5px var(--shadow-color-light); }
.results-title { text-align: center; font-size: 1.6em; color: var(--secondary-color); margin-top: 0; margin-bottom: 30px; padding-bottom: 15px; border-bottom: 2px solid var(--primary-color); font-weight: 700; position: relative; }
.results-title::before { content: 'üìä'; display: inline-block; margin-right: 10px; font-size: 0.9em; }
.results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; padding-bottom: 25px; border-bottom: 1px solid #eee; margin-bottom: 25px; }
.result-category-column { background-color: rgba(255, 255, 255, 0.7); border-radius: var(--border-radius-small); border: 1px solid #eee; padding: 10px; text-align: center; transition: var(--transition-std); box-shadow: 0 2px 4px var(--shadow-color-light); }
.result-category-column:hover { box-shadow: 0 5px 10px var(--shadow-color-medium); transform: translateY(-2px); }
.result-category-column h4 { margin-top: 0; margin-bottom: 10px; font-size: 1.0em; font-weight: 700; padding-bottom: 5px; border-bottom: 2px solid; text-transform: uppercase; letter-spacing: 0.8px; }
.result-category-column.win h4 { border-color: var(--win-color); color: var(--win-color); }
.result-category-column.top2 h4 { border-color: var(--top2-color); color: var(--top2-color); }
.result-category-column.high h4 { border-color: #81c784; color: #388e3c; }
.result-category-column.safe h4 { border-color: #bdbdbd; color: #757575; }
.result-category-column.low h4 { border-color: var(--low-color); color: #d32f2f; }
.result-category-column.btm h4 { border-color: var(--btm-color); color: #e64a19; }
.result-category-column.immune h4 { border-color: var(--immune-color); color: #1976d2; }
.result-cards-container-column { display: flex; flex-direction: column; gap: 12px; align-items: stretch; }

/* Mini Cards in Results Grid */
.result-card.mini { display: flex; align-items: center; flex-direction: column; gap: 5px; padding: 8px; background-color: var(--card-bg); border: 1px solid var(--border-color); border-radius: var(--border-radius-small); box-shadow: 0 1px 3px var(--shadow-color-light); width: 100%; text-align: center; position: relative; transition: var(--transition-fast); border-left: 3px solid transparent; min-height: 90px; justify-content: center; }
.result-card.mini:hover { transform: scale(1.03); box-shadow: 0 3px 7px var(--shadow-color-medium); }
.result-card.mini.track-win { border-left-color: var(--win-color); }
.result-card.mini.track-top2 { border-left-color: var(--top2-color); }
.result-card.mini.track-high { border-left-color: #81c784; }
.result-card.mini.track-safe { border-left-color: #bdbdbd; }
.result-card.mini.track-low { border-left-color: var(--low-color); }
.result-card.mini.track-btm { border-left-color: var(--btm-color); }
.result-card.mini.track-immune { border-left-color: var(--immune-color); }
.result-card.mini .result-card-img.mini { width: 45px; height: 45px; object-fit: cover; border-radius: 50%; flex-shrink: 0; border: 1px solid #eee; margin-bottom: 3px; }
.result-card.mini .result-card-name.mini { font-size: 0.8em; font-weight: 500; flex-grow: 1; line-height: 1.1; }
.result-card.mini .immunity-badge.small-badge { position: absolute; top: 2px; right: 2px; font-size: 1em; padding: 0; color: var(--immune-color); text-shadow: 0 0 3px rgba(0,0,0,0.4); line-height: 1; }

/* Critiques Section */
.results-critiques-section { margin-top: 25px; padding: 20px; background-color: #fdfdfd; border-radius: var(--border-radius-small); border: 1px solid #eaeaea; box-shadow: inset 0 1px 4px rgba(0,0,0,0.04); }
.critiques-section-title { text-align: center; font-size: 1.5em; color: var(--secondary-color); margin-bottom: 25px; padding-bottom: 10px; border-bottom: 1px dashed var(--secondary-color); font-weight: 600; }
.critiques-placement-group { margin-bottom: 20px; padding-left: 15px; border-left: 3px solid #ccc; }
.critiques-placement-group:last-child { margin-bottom: 0; }
.critiques-placement-group.win { border-left-color: var(--win-color); } .critiques-placement-group.win h5 { color: var(--win-color); }
.critiques-placement-group.top2 { border-left-color: var(--top2-color); } .critiques-placement-group.top2 h5 { color: var(--top2-color); }
.critiques-placement-group.high { border-left-color: #81c784; } .critiques-placement-group.high h5 { color: #388e3c; }
.critiques-placement-group.low { border-left-color: var(--low-color); } .critiques-placement-group.low h5 { color: #d32f2f; }
.critiques-placement-group.btm { border-left-color: var(--btm-color); } .critiques-placement-group.btm h5 { color: #e64a19; }
.critiques-placement-group h5 { font-size: 1.1em; font-weight: 700; text-transform: uppercase; margin-bottom: 12px; letter-spacing: 0.5px; position: relative; padding-left: 5px; }
.critique-entry { font-size: 1em; line-height: 1.6; color: #555; margin-bottom: 12px; padding: 8px; background-color: rgba(255, 255, 255, 0.5); border-radius: 4px; border: 1px solid #f0f0f0; }
.critique-entry:last-child { margin-bottom: 0; }
.critique-entry strong { font-weight: 600; color: var(--text-color); margin-right: 8px; }
.critique-entry strong::after { content: ':'; }

/* Final Outcome Text */
.final-outcome-text { margin: 25px auto; font-weight: 600; text-align: center; font-size: 1.2em; color: var(--secondary-color); padding: 15px; border-radius: var(--border-radius-small); background-color: rgba(230, 230, 230, 0.4); border: 1px solid var(--border-color); max-width: 90%; line-height: 1.5; }
.final-outcome-text.hidden { display: none; }

/* --- Track Record --- */
.track-record-container { overflow-x: auto; margin-top: 25px; border: none; border-radius: var(--border-radius); box-shadow: 0 5px 15px var(--shadow-color-medium); background-color: white; }
#track-record-table { width: 100%; border-collapse: separate; border-spacing: 0; margin-bottom: 0; white-space: nowrap; border-radius: var(--border-radius); overflow: hidden; table-layout: fixed; }
#track-record-table th,
#track-record-table td { border: none; padding: 8px 10px; text-align: center; font-size: 0.85em; vertical-align: middle !important; border-bottom: 1px solid #f0f0f0; width: 70px; overflow: hidden; text-overflow: ellipsis; }
#track-record-table th { padding: 12px 12px; }
#track-record-table thead th {
    background-color: #f8f9fa;
    color: #495057;
    border-bottom: 2px solid #dee2e6;
    position: sticky;
    top: 0;
    z-index: 3; /* Ensure header is above cells */
    font-weight: 600;
    font-size: 0.8em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: normal; /* Allow header text to wrap */
    line-height: 1.3;
}
#track-record-table th.queen-header-col {
    /* --- ADJUSTED --- */
    min-width: 75px;  /* Reduced width */
    width: 75px;      /* Reduced width */
    text-align: center; /* Center "QUEEN" header text */
    padding: 12px 5px; /* Adjust padding */
    /* --- END ADJUSTED --- */
    position: sticky;
    left: 0;
    z-index: 4; /* Header needs higher z-index */
    background-color: #f8f9fa !important;
    border-right: 1px solid #dee2e6;
}#track-record-table tbody td { background-color: transparent; color: var(--text-color); transition: background-color 0.2s ease; font-weight: 500; }
#track-record-table tbody tr:nth-child(even) { background-color: #fdfdfd; }

#track-record-table td.queen-name-col {
    font-weight: 600;
    /* --- ADJUSTED --- */
    text-align: center !important; /* Center the image horizontally */
    vertical-align: middle !important; /* Center image vertically */
    width: 75px; /* Match header width */
    min-width: 75px; /* Match header min-width */
    padding: 5px; /* Reduced padding */
    /* --- END ADJUSTED --- */
    position: sticky;
    left: 0;
    z-index: 2; /* Cells below header */
    border-right: 1px solid #dee2e6;
    background-color: inherit; /* Keeps alternating row color */
    /* No longer need flex/gap or display: inline-block logic here */
}
#track-record-table td.queen-name-col img,
#track-record-table td.queen-name-col span {
    display: inline-block;
    vertical-align: middle;
    margin-right: 8px;
}
#track-record-table td.queen-name-col img {
    /* Inherit display: block or inline-block is fine, centering is done by cell */
    width: 38px; /* Keep image size consistent */
    height: 38px; /* Keep image size consistent */
    object-fit: cover;
    border-radius: 50%;
    border: 1px solid var(--border-color);
    box-shadow: 0 1px 2px var(--shadow-color-light);
    margin: 0; /* Remove margin if any */
    vertical-align: middle; /* Ensure it aligns nicely if TD display changes */
}
#track-record-table td.queen-name-col span {
    line-height: 1.3;
    max-width: calc(100% - 38px - 8px); /* Img width + margin */
}
/* --- End Track Record V4 Alignment Fix --- */

.track-record-queen-img { /* General image style if used elsewhere */ width: 38px; height: 38px; object-fit: cover; border-radius: 50%; border: 1px solid var(--border-color); flex-shrink: 0; box-shadow: 0 1px 2px var(--shadow-color-light); transition: transform 0.2s ease; }
#track-record-table td.status-eliminated { font-style: italic; opacity: 0.7; }
#track-record-table td.status-eliminated span { text-decoration: line-through; }
#track-record-table td.status-winner { background-color: inherit !important; }
#track-record-table td.status-winner .track-record-queen-img { border: 3px solid gold; }
#track-record-table td.status-winner span { color: #b38600; font-weight: 700; }
#track-record-table td.status-runnerup { background-color: inherit !important; }
#track-record-table td.status-runnerup .track-record-queen-img { border: 3px solid silver; }
#track-record-table td.status-runnerup span { color: #555; font-weight: 600; }
#track-record-table tbody tr td[class*="track-"]:not(.track-inactive):not(.track-future) { font-weight: 500; font-size: 0.85em; }
#track-record-table tbody tr td.track-WIN { background-color: var(--win-color); color: white; font-weight: 700; }
#track-record-table tbody tr td.track-TOP2 { background-color: var(--top2-color); color: #111; font-weight: 700; }
#track-record-table tbody tr td.track-HIGH { background-color: var(--high-color); }
#track-record-table tbody tr td.track-SAFE { background-color: transparent; color: #777; font-weight: 400; border: 1px dotted #ccc; }
#track-record-table tbody tr td.track-LOW { background-color: var(--low-color); }
#track-record-table tbody tr td.track-BTM { background-color: var(--btm-color); font-weight: 600; }
#track-record-table tbody tr td.track-ELIM { background-color: var(--elim-color); color: white; font-weight: 700; }
#track-record-table tbody tr td.track-IMMUNE { background-color: var(--immune-color); color: #0d47a1; font-weight: 600; }
#track-record-table tbody tr td.track-WINNER { background-color: var(--winner-color); color: #4f3b00; font-weight: 700; font-size: 0.9em; }
#track-record-table tbody tr td.track-RUNNER-UP { background-color: var(--runnerup-color); color: #444; font-weight: 600; }
#track-record-table tbody td.track-inactive { background-color: #6c757d !important; color: transparent !important; font-style: normal !important; font-weight: 400 !important; cursor: default; border-color: #5a6268; border: none !important; text-indent: -9999px;}
#track-record-table tbody td.track-inactive::before { content: none !important; }
#track-record-table tbody td.track-future { color: #d0d0d0; font-style: italic; background-color: rgb(100, 100, 100); border: none !important; }
/* Style the Avg PPE and final Place/MQP columns */
#track-record-table th:nth-last-child(-n+2),
#track-record-table td:nth-last-child(-n+2) {
    font-size: 0.8em;      /* Keep small font size */
    width: 55px;          /* Maybe slightly wider than old stats */
    background-color: #f8f9fa; /* Header-like background */
    border-left: 1px solid #eee;
    font-weight: 600; /* Make stat values bolder */
    text-align: center; /* Center align these values */
}
/* Alternate row background for these stat columns */
#track-record-table tbody tr:nth-child(even) td:nth-last-child(-n+2) {
    background-color: #f1f3f5; /* Lighter alternate color */
}

/* Add specific class styling if needed */
#track-record-table td.ppe-cell {
    /* Optional: specific style for PPE */
    color: #4a148c; /* Example: Deep purple for PPE */
}
#track-record-table td.mqp-cell {
     /* Optional: specific style for MQP */
     color: #e65100; /* Example: Orange for MQP */
}
#track-record-table td.final-place-cell {
    /* Inherits base stat styling but keeps existing WINNER/RU colors */
    font-weight: 700; /* Keep final rank bold */
    width: 70px; /* Keep final place a bit wider if needed */
}

#track-record-table td.final-place-cell { font-weight: 700; font-size: 0.85em; width: 70px; }
#track-record-table td.final-place-cell.track-WINNER { background-color: var(--winner-color); color: #4f3b00; }
#track-record-table td.final-place-cell.track-RUNNER-UP { background-color: var(--runnerup-color); color: #444; }

/* --- Final Results --- */
#final-results-screen .screen-header h2 { color: var(--primary-color); border-bottom-color: var(--primary-color); font-size: 2.6em; }
#final-results-screen .screen-header h2::after { content: 'üëë'; color: var(--accent-color); }
#winner-announcement { padding: 40px 20px; margin-bottom: 40px; background: linear-gradient(135deg, #fff1f7, #f5f5ff); border-radius: var(--border-radius); border: 2px solid; border-image: linear-gradient(to right, var(--accent-color), var(--primary-color)) 1; box-shadow: 0 6px 20px rgba(106, 13, 173, 0.15); }
#winner-announcement .reveal-text { font-size: 1.4em; font-style: normal; font-weight: 400; color: #666; margin-bottom: 15px; line-height: 1.5; }
#winner-announcement .reveal-text:first-child { font-weight: 600; }
#winner-announcement .winner-reveal { margin: 30px 0; position: relative; display: inline-block; }
#winner-img { display: block; width: 220px; height: 220px; object-fit: cover; border-radius: 50%; border: 10px solid; border-image: linear-gradient(45deg, var(--accent-color), #fff7d6, var(--accent-color)) 1; margin: 0 auto 20px auto; box-shadow: 0 10px 30px var(--shadow-color-medium), 0 0 20px var(--accent-color); transition: var(--transition-std); }
#winner-img:hover { transform: scale(1.05); box-shadow: 0 15px 35px var(--shadow-color-strong), 0 0 30px var(--accent-color); }
#winner-name { font-size: 3.8em; font-weight: 700; color: var(--secondary-color); text-transform: uppercase; letter-spacing: 2px; margin: 0 0 15px 0; text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.9), 3px 3px 6px var(--shadow-color-medium); }
#winner-announcement .final-words { font-size: 1.6em; font-weight: 700; color: var(--primary-color); margin-top: 25px; font-style: normal; letter-spacing: 0.5px; }
.finalists-display { padding: 30px; margin-top: 25px; text-align: center; border-top: 1px solid #eee; background-color: #fdfdfd; border-radius: var(--border-radius); }
.finalists-display h4 { font-size: 1.4em; color: #555; margin-top: 0; margin-bottom: 15px; font-weight: 600; }
.finalists-display p { font-size: 1.3em; color: var(--text-color); line-height: 1.6; font-weight: 500; }

/* --- Confetti --- */
.confetti { position: fixed; top: -25px; left: 0; width: 10px; height: 18px; background-color: var(--primary-color); opacity: 0.9; animation: fall 5s linear infinite; z-index: 9999; pointer-events: none; border-radius: 3px; filter: brightness(1.1); }
.confetti:nth-child(3n) { background-color: var(--secondary-color); animation-duration: 6s; }
.confetti:nth-child(4n) { background-color: var(--accent-color); animation-duration: 4s; height: 10px; width: 10px; border-radius: 50%; }
.confetti:nth-child(5n) { background-color: #ffffff; animation-duration: 7s; opacity: 0.7; height: 15px; width: 7px; }
.confetti:nth-child(7n) { background-color: var(--top2-color); animation-duration: 5.5s; }
.confetti:nth-child(11n) { background-color: #f8bbd0; animation-duration: 6.5s; }
@keyframes fall { 0% { transform: translateY(0) rotateZ(0deg) rotateY(0deg); opacity: 1; } 50% { opacity: 0.9; } 100% { transform: translateY(110vh) rotateZ(720deg) rotateY(360deg); opacity: 0; } }

/* --- Responsive --- */
@media (max-width: 992px) { /* Medium devices (tablets, smaller desktops) */
    .container { padding: 30px 25px; }
    .queen-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
    .results-grid { grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 20px; }
}
@media (max-width: 768px) { /* Small devices (landscape phones, tablets) */
    body { padding: 15px; }
    .container { padding: 20px; max-width: 98%; }
    h1 { font-size: 2.4em; } h2 { font-size: 2.0em; } h3 { font-size: 1.5em; } h4 { font-size: 1.2em; }
    .queen-grid { grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 15px; }
    .queen-selector img { width: 70px; height: 70px; }
    #track-record-table th, #track-record-table td { font-size: 0.85em; padding: 8px 10px; }
    .track-record-queen-img { width: 35px; height: 35px;}
    #track-record-table th.queen-header-col { min-width: 170px; width: 170px; }
    #track-record-table td.queen-name-col { width: 170px; gap: 0; /* Rely on margin now */ padding: 5px 10px; } /* Align width and padding */
     #track-record-table td.queen-name-col img { margin-right: 8px; } /* Add margin for space */
    button { padding: 11px 22px; }
    .choice-button-card.enhanced { width: 160px; min-height: 230px;}
    .choice-button-card.enhanced img { width: 75px; height: 75px; }
    .choice-button-card.enhanced .stat-icon { font-size: 1.4em; }
    .choice-button-card.enhanced .stat-count { font-size: 0.9em; }
    .navigation-buttons { flex-direction: column; gap: 10px; }
}
@media (max-width: 480px) { /* Extra small devices (phones) */
    body { padding: 10px; font-size: 15px; }
    .container { padding: 15px; }
    h1 { font-size: 2.0em; } h2 { font-size: 1.7em; } h3 { font-size: 1.4em; } h4 { font-size: 1.1em; }
    .subtitle { font-size: 1em; margin-bottom: 30px; }
    .setup-options { grid-template-columns: 1fr; gap: 25px;}
     .queen-grid { grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 12px; }
    .queen-selector img { width: 60px; height: 60px; } .queen-selector span { font-size: 0.85em;}
    .active-display-card { width: 75px; } .active-display-card img { width: 45px; height: 45px;} .active-display-card span { font-size: 0.75em;}
    button { font-size: 0.9em; padding: 10px 18px;}
    .results-grid { grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 10px;}
    .result-category-column { padding: 8px; }
    .result-category-column h4 { font-size: 0.9em; }
    .result-card.mini { padding: 5px; min-height: 80px;} .result-card.mini .result-card-img.mini { width: 40px; height: 40px;} .result-card.mini .result-card-name.mini { font-size: 0.75em;}
    .critiques-section-title { font-size: 1.3em;} .critique-entry { font-size: 0.9em;}
    #winner-img { width: 160px; height: 160px; border-width: 8px; }
    #winner-name { font-size: 2.6em; }
    #winner-announcement .reveal-text { font-size: 1.1em; } #winner-announcement .final-words { font-size: 1.3em; }
    #track-record-table th, #track-record-table td { font-size: 0.75em; padding: 6px 4px; width: 50px;}
    .track-record-queen-img { width: 30px; height: 30px;}
    #track-record-table th.queen-header-col { min-width: 130px; width: 130px;}
    #track-record-table td.queen-name-col { width: 130px; gap: 0; padding: 4px 8px; }
    #track-record-table td.queen-name-col img { margin-right: 5px; width: 30px; height: 30px; }
    @media (max-width: 480px) {
        #track-record-table th:nth-last-child(-n+2), #track-record-table td:nth-last-child(-n+2) {
            width: 40px;
            font-size: 0.7em;
        }
         #track-record-table td.final-place-cell {
            width: 50px; /* Adjust final place width if needed */
         }
   }
    #track-record-table td.final-place-cell { width: 50px; }
    .choice-button-card.enhanced { width: 130px; min-height: 200px;}
    .choice-button-card.enhanced img { width: 65px; height: 65px; }
    .choice-button-card.enhanced .queen-name { font-size: 1em; }
    .choice-button-card.enhanced .stat-icon { font-size: 1.3em;}
    .choice-button-card.enhanced .stat-count { font-size: 0.9em;}
    .choice-card-container { gap: 10px; }
}

/* --- AS10 Merge Qualifier Popup/Modal --- */
.modal-overlay {
    position: fixed; /* Sit on top of everything */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.65); /* Dark semi-transparent background */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000; /* Ensure it's above other content */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0s linear 0.3s;
}
.modal-overlay:not(.hidden) { /* When not hidden */
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease;
}

.modal-content {
    background: var(--container-bg);
    padding: 35px 40px;
    border-radius: var(--border-radius);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
    width: 90%;
    max-width: 750px; /* Limit max width */
    text-align: center;
    transform: scale(0.9);
    opacity: 0;
    transition: transform 0.3s ease-out, opacity 0.3s ease-out;
}
.modal-overlay:not(.hidden) .modal-content {
    transform: scale(1);
    opacity: 1;
}


/* Specific styles for Merge Announcement Box */
.merge-announcement-box {
    border-top: 5px solid var(--primary-color);
}
.merge-announcement-box h3 {
    color: var(--primary-color);
    font-size: 1.8em;
    margin-bottom: 20px;
    font-weight: 700;
}
.merge-description {
    font-size: 1.05em;
    color: #555;
    margin-bottom: 25px;
    line-height: 1.6;
}
.merge-description.footnote {
    font-size: 0.9em;
    margin-top: 25px;
    margin-bottom: 15px;
    font-style: italic;
    color: #777;
}

/* Grid for Qualifier Cards */
.qualifier-card-grid {
    display: flex; /* Changed to flex */
    flex-wrap: wrap; /* Allow wrapping */
    gap: 20px; /* Space between cards */
    justify-content: center; /* Center the cards */
    align-items: stretch; /* Make cards same height if needed */
    margin-bottom: 20px;
    padding: 15px;
    background-color: rgba(240, 240, 250, 0.4);
    border-radius: var(--border-radius-small);
    border: 1px dashed #c9b7e2;
}

/* Mini Card Style for Qualifiers */
.qualifier-card {
    background-color: #fff;
    border: 2px solid var(--secondary-color);
    border-radius: var(--border-radius-small);
    padding: 15px 10px;
    text-align: center;
    box-shadow: 0 3px 8px rgba(106, 13, 173, 0.1);
    width: 130px; /* Fixed width for better alignment */
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: transform 0.2s ease;
}
.qualifier-card:hover {
    transform: translateY(-4px) scale(1.03);
    box-shadow: 0 6px 12px rgba(106, 13, 173, 0.2);
}

.qualifier-card img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 10px;
    border: 3px solid #e0e0e0;
}

.qualifier-card .queen-name {
    font-size: 1em;
    font-weight: 600;
    color: var(--secondary-color);
    line-height: 1.3;
    margin-bottom: 5px;
    flex-grow: 1; /* Allow name to push MQP down */
}

.qualifier-card .mqp-score {
    font-size: 0.85em;
    font-weight: 700;
    color: var(--primary-color);
    background-color: #fdf0f7;
    padding: 3px 8px;
    border-radius: 10px;
    margin-top: auto; /* Push to bottom */
}

.modal-actions {
    margin-top: 30px;
}
/* --- Styles for LaLaPaRUza UI inside LipSync Box --- */
/* LaLaPaRUza Controls */
#lalaparuza-controls {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px dashed var(--border-color);
}

#lalaparuza-next-step-button {
    padding: 10px 25px; /* Slightly larger than default small */
    font-size: 0.95em;
}

#lalaparuza-ui { /* Adjust existing interaction-box */
    background: rgba(255, 240, 245, 0.8); /* Semi-transparent pink background */
    padding: 25px;
    border: 2px dashed var(--primary-color); /* Dashed pink border */
    margin-top: 15px; /* Add some space above if needed */
    box-shadow: 0 4px 12px rgba(230, 0, 126, 0.15); /* Lighter shadow */
}
#lalaparuza-title {
    color: var(--primary-color); /* Pink title */
    font-size: 1.6em; /* Slightly larger title */
    margin-bottom: 20px;
    font-weight: 700;
    letter-spacing: 1px;
}
#lalaparuza-round-display {
    margin-bottom: 15px;
    padding-right: 10px;
    max-height: 350px; /* Increased max height */
    overflow-y: auto;
    border-radius: 6px;
    border: 1px solid #ffe0f0;
    background-color: rgba(255, 255, 255, 0.7); /* Make slightly more opaque */
}
/* Style for round headers inside the display */
#lalaparuza-round-display h5 {
    text-align: center;
    font-size: 1.2em;
    font-weight: 700;
    color: var(--secondary-color); /* Purple for round headers */
    padding: 10px 0;
    margin: 10px 0 15px 0;
    border-top: 1px solid var(--border-color);
    border-bottom: 1px solid var(--border-color);
    background-color: rgba(245, 245, 255, 0.5); /* Light purple tint */
    position: sticky; /* Keep round headers visible */
    top: -10px; /* Adjust based on padding */
    z-index: 1;
}

.lalaparuza-matchup {
    display: flex;
    justify-content: center; /* Align items horizontally center */
    align-items: center;
    margin: 0 auto 12px auto; /* Centered with bottom margin */
    padding: 10px 15px;
    background: white;
    border-radius: var(--border-radius-small);
    box-shadow: 0 2px 5px var(--shadow-color-light);
    font-size: 0.95em;
    max-width: 90%; /* Prevent overly wide matchups */
    transition: box-shadow 0.2s ease;
}
.lalaparuza-matchup:hover {
    box-shadow: 0 4px 8px var(--shadow-color-medium);
}

/* Adjusted flex basis for better centering */
.lalaparuza-matchup .queen-name {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-basis: 42%; /* Adjust percentage */
    text-align: left; /* Align name text left */
    justify-content: flex-start; /* Justify towards start */
    line-height: 1.3;
}
/* Ensure the second queen is aligned to the right */
.lalaparuza-matchup .queen-name:last-of-type {
    text-align: right; /* Align name text right */
    justify-content: flex-end; /* Justify towards end */
}

.lalaparuza-matchup .queen-img-small {
    width: 32px; /* Slightly larger */
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #eee;
    flex-shrink: 0; /* Prevent shrinking */
}

.lalaparuza-matchup .vs {
    font-weight: 700;
    color: var(--secondary-color);
    font-size: 1.4em; /* Slightly smaller VS */
    padding: 0 12px; /* Adjusted padding */
    flex-shrink: 0;
    flex-grow: 0;
}

.lalaparuza-matchup .matchup-winner {
    font-weight: 700;
    color: #28a745; /* Green for winner */
}
.lalaparuza-matchup .matchup-winner .queen-img-small {
    border-color: #28a745; /* Green border */
}
.lalaparuza-matchup .matchup-loser {
    text-decoration: line-through;
    color: #a9a9a9; /* Darker gray */
    opacity: 0.75; /* Slightly less opaque */
}
.lalaparuza-matchup .matchup-loser .queen-img-small {
    opacity: 0.6;
    filter: grayscale(50%);
}

/* Style for bye message */
#lalaparuza-round-display p em {
    display: block;
    text-align: center;
    font-style: italic;
    color: #666;
    padding: 8px 0;
    margin: 5px 0 15px 0;
    font-size: 0.9em;
}

#lalaparuza-winner-announcement {
    margin-top: 20px;
    font-size: 1.3em; /* Larger announcement */
    font-weight: bold;
    text-align: center;
    color: var(--secondary-color);
    padding: 12px;
    background-color: #e8e0ff;
    border-radius: 5px;
    border: 1px solid var(--secondary-color);
}
#lalaparuza-winner-announcement strong {
    color: var(--primary-color); /* Winner name in pink */
    font-size: 1.1em; /* Make name slightly bigger */
}/* --- ADD THESE STYLES FOR AS10 MQP Choice Cards --- */

/* Target the container holding the MQP choice cards */
#mqp-choice-options {
    display: flex; /* Use flexbox for layout */
    flex-wrap: wrap; /* Allow cards to wrap to the next line */
    justify-content: center; /* Center cards horizontally */
    gap: 10px; /* Reduced gap between cards */
    padding: 15px 0; /* Add some padding */
    max-height: 250px; /* Limit height and allow scrolling if needed */
    overflow-y: auto; /* Enable vertical scrolling if needed */
     border: 1px dashed #d1c4e9; /* Light border */
     border-radius: var(--border-radius-small);
     background-color: rgba(255, 255, 255, 0.6); /* Slight background */
}

/* Override styles for cards specifically in the MQP context */
#mqp-distribution-ui .choice-button-card.mqp-recipient {
    width: 100px; /* Significantly smaller width */
    min-height: 140px; /* Reduced minimum height */
    padding: 10px 5px 5px 5px; /* Adjust padding */
    border-width: 2px; /* Keep border consistent */
    cursor: default; /* Not clickable (display only) */
    box-shadow: 0 2px 4px var(--shadow-color-light); /* Lighter shadow */
    transform: none !important; /* Prevent hover transform */
}
/* No hover effect needed for MQP recipients */
#mqp-distribution-ui .choice-button-card.mqp-recipient:hover {
    border-color: var(--border-color); /* Reset border color */
    box-shadow: 0 2px 4px var(--shadow-color-light); /* Reset shadow */
    transform: none;
}

/* Adjust image size within MQP cards */
#mqp-distribution-ui .choice-button-card.mqp-recipient .card-main-info img {
    width: 60px; /* Smaller image */
    height: 60px; /* Smaller image */
    margin-bottom: 8px; /* Adjust margin */
    border-width: 2px; /* Thinner border */
    transform: none !important; /* Prevent hover transform */
}

/* Adjust name font size and position */
#mqp-distribution-ui .choice-button-card.mqp-recipient .name-score-group {
    margin-bottom: 5px; /* Less margin */
}
#mqp-distribution-ui .choice-button-card.mqp-recipient .queen-name {
    font-size: 0.9em; /* Smaller font */
    line-height: 1.2; /* Adjust line height */
    margin-top: 5px; /* Add a little space above */
    padding: 0 2px; /* Less horizontal padding */
    display: block; /* Ensure block display */
}

/* Adjust the points bubble positioning */
#mqp-distribution-ui .mqp-card-points {
    position: absolute;
    bottom: 3px; /* Adjusted position */
    right: 3px;  /* Adjusted position */
    width: 20px;
    height: 20px;
    font-size: 0.75em;
    line-height: 20px;
}

/* Override the selected state visual - make it less pronounced or different */
#mqp-distribution-ui .mqp-recipient.mqp-selected {
    border-color: var(--secondary-color); /* Purple border for selection */
    background-color: #f2e6ff; /* Very light purple background */
    box-shadow: 0 0 8px rgba(106, 13, 173, 0.3); /* Purple glow */
    transform: none; /* Prevent scaling */
}

/* Style the Donor/Recipient info text */
#mqp-donor-info-wrapper {
    padding: 10px;
    margin-bottom: 10px;
    background-color: rgba(255, 255, 255, 0.7);
    border-radius: var(--border-radius-small);
    border: 1px solid var(--border-color);
}
#mqp-donor-info {
    font-size: 1.15em;
    color: var(--secondary-color);
    font-weight: 600;
}
#mqp-recipient-info {
     font-size: 0.9em;
     color: #666;
     margin-top: 5px;
     font-style: italic;
}
/* Center content utility class */
.center-content {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column; /* Stack elements vertically if needed */
}
/* --- AS10 Group Reveal Screen Styles --- */
#as10-group-reveal-screen .screen-header h2 {
    color: var(--secondary-color);
}

.group-reveal-container {
    display: flex;
    gap: 25px;
    margin-top: 30px;
    margin-bottom: 40px;
    justify-content: space-around; /* Distribute space */
}

.group-column {
    flex: 1; /* Each column takes equal space */
    min-width: 0; /* Allows flex items to shrink */
    background-color: rgba(255, 255, 255, 0.6);
    border-radius: var(--border-radius);
    padding: 20px 15px;
    border: 1px solid var(--border-color);
    box-shadow: inset 0 1px 4px rgba(0,0,0,0.05);
    text-align: center;
}

.group-column h4 {
    font-size: 1.4em;
    margin-top: 0;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid;
    font-weight: 700;
    display: flex; /* Align icon and text */
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.group-column.group-a h4 { border-color: #ff69b4; color: #ff69b4; } /* Pink */
.group-column.group-b h4 { border-color: #87ceeb; color: #87ceeb; } /* Sky Blue */
.group-column.group-c h4 { border-color: #90ee90; color: #90ee90; } /* Light Green */

.reveal-cards-container {
    display: flex;
    flex-direction: column; /* Stack cards vertically */
    gap: 12px; /* Space between cards */
    max-height: 45vh; /* Limit height */
    overflow-y: auto; /* Add scroll if needed */
    padding-right: 5px; /* Space for scrollbar */
    scrollbar-width: thin;
    scrollbar-color: var(--secondary-color) var(--background-end);
}
.reveal-cards-container::-webkit-scrollbar { width: 6px; }
.reveal-cards-container::-webkit-scrollbar-track { background: transparent; }
.reveal-cards-container::-webkit-scrollbar-thumb { background-color: var(--secondary-color); border-radius: 3px; }


.reveal-queen-card {
    display: flex;
    align-items: center;
    background-color: var(--card-bg);
    padding: 8px 10px;
    border-radius: var(--border-radius-small);
    border: 1px solid var(--border-color);
    box-shadow: 0 2px 4px var(--shadow-color-light);
    width: 100%; /* Take full width of column */
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.reveal-queen-card:hover {
    transform: translateX(3px);
    box-shadow: 0 4px 8px var(--shadow-color-medium);
}

.reveal-queen-card img {
    width: 45px;
    height: 45px;
    object-fit: cover;
    border-radius: 50%;
    margin-right: 12px;
    border: 2px solid #eee;
    flex-shrink: 0; /* Prevent image shrinking */
}

.reveal-queen-card span {
    font-weight: 500;
    font-size: 1.0em;
    color: var(--text-color);
    line-height: 1.3;
    text-align: left; /* Align name to the left */
}

/* Style the continue button */
#confirm-group-reveal-button .arrow {
    display: inline-block;
    transition: transform 0.2s ease-out;
    margin-left: 5px;
}
#confirm-group-reveal-button:hover .arrow {
    transform: translateX(4px);
}

/* Responsive adjustment for smaller screens if needed */
@media (max-width: 768px) {
    .group-reveal-container {
        flex-direction: column; /* Stack columns vertically */
        gap: 20px;
    }
    .reveal-cards-container {
        max-height: none; /* Remove height limit when stacked */
        overflow-y: visible;
    }
}